{"files":[{"id":"2bcebef8-cb28-4389-a50f-948124920e72","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Asia/Bangkok\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE_ANONYMOUS\"\n  }\n}"},{"id":"51af8062-11ab-41dc-ad3b-13a104c39c3c","name":"Code","type":"server_js","source":"function doGet(request) {\n  var ctzid \u003d request.parameter.ctzid;\n  var lineid \u003d request.parameter.lineid;\n\n  // Log the input parameters\n  Logger.log(\"ctzid: \" + ctzid);\n  Logger.log(\"lineid: \" + lineid);\n\n  // Validate inputs\n  if (!ctzid || !lineid) {\n    Logger.log(\"Error: Missing required fields\");\n    return ContentService.createTextOutput(JSON.stringify({ status: \u0027error\u0027, message: \u0027Missing required fields\u0027 }))\n      .setMimeType(ContentService.MimeType.JSON);\n  }\n\n  // Access the Google Spreadsheet\n  var ss \u003d SpreadsheetApp.openByUrl(\"https://docs.google.com/spreadsheets/d/1X8xIurq1VBxduSGaeW-s93Le5S2BPGWR_CTCEyS3nP4/edit?usp\u003dsharing\");\n  var sheet \u003d ss.getSheetByName(\u0027Register\u0027);\n\n  // Check for matching lineid and ctzid\n  var data \u003d sheet.getDataRange().getValues();\n  var found \u003d false;\n\n  for (var i \u003d 1; i \u003c data.length; i++) {\n    if (data[i][5].toString() \u003d\u003d\u003d ctzid \u0026\u0026 data[i][7] \u003d\u003d\u003d lineid) { \n      // Change the data in the matched row to \"ไม่มี\"\n      sheet.getRange(i + 1, 9).setValue(\"ไม่มี\");\n      sheet.getRange(i + 1, 10).setValue(\"ไม่มี\");\n      found \u003d true;\n      Logger.log(\"Match found. Updating row \" + (i + 1));\n      break;\n    }\n  }\n\n  if (found) {\n    var result \u003d { status: \u0027success\u0027, message: \u0027Data updated to \"ไม่มี\" successfully\u0027 };\n    Logger.log(result.message);\n    return ContentService.createTextOutput(JSON.stringify(result)).setMimeType(ContentService.MimeType.JSON);\n  } else {\n    Logger.log(\"Error: No matching data found\");\n    return ContentService.createTextOutput(JSON.stringify({ status: \u0027error\u0027, message: \u0027No matching data found\u0027 }))\n      .setMimeType(ContentService.MimeType.JSON);\n  }\n}\n"}]}