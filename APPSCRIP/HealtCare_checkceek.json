{"files":[{"id":"86289e45-2793-4344-9208-99adc6e1de2d","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Asia/Bangkok\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE_ANONYMOUS\"\n  }\n}"},{"id":"6ea12342-9f5a-40c1-af06-2118ce487e45","name":"Code","type":"server_js","source":"function doGet(request) {\n  var name \u003d request.parameter.name;\n\n  // Access the Google Spreadsheet\n  var ss \u003d SpreadsheetApp.openByUrl(\"https://docs.google.com/spreadsheets/d/1X8xIurq1VBxduSGaeW-s93Le5S2BPGWR_CTCEyS3nP4/edit?usp\u003dsharing\");\n  var sheet \u003d ss.getSheetByName(\u0027HealCheck\u0027);\n  \n  // Get all data from the sheet\n  var data \u003d sheet.getDataRange().getValues();\n\n  var foundData \u003d null;\n  for (var i \u003d 1; i \u003c data.length; i++) { \n    if (data[i][1] \u003d\u003d\u003d name) {\n      foundData \u003d data[i];  \n      break;\n    }\n  }\n  \n  // Return appropriate messages based on duplicate check\n  if (foundData) {\n    // If a match is found, return the row data\n    var result \u003d {\n      status: \u0027success\u0027,\n      message: \u0027มีการนัดตรวจร่างกาย\u0027,\n      data: {\n        title: foundData[0],\n        name: foundData[1],\n        datecheck: foundData[2],\n        symtom: foundData[3],\n        docor: foundData[4],\n        aesult: foundData[5]\n      }\n    };  \n    return ContentService.createTextOutput(JSON.stringify(result))\n      .setMimeType(ContentService.MimeType.JSON);\n  } else {\n    var result \u003d {\n      status: \u0027fail\u0027,\n      message: \u0027ไม่มีการนัดตรวจร่างกาย\u0027,\n      data: {\n        title: \u0027\u0027,\n        name: \u0027\u0027,\n        datecheck: \u0027\u0027,\n        symtom: \u0027\u0027,\n        docor: \u0027\u0027,\n        aesult: \u0027\u0027\n      }\n    };\n    return ContentService.createTextOutput(JSON.stringify(result))\n      .setMimeType(ContentService.MimeType.JSON);\n  }\n}"}]}