{"files":[{"id":"aa87018a-ddae-43f6-b6e2-ebd164ca0cc0","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Asia/Bangkok\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE_ANONYMOUS\"\n  }\n}"},{"id":"72f908c1-a3a3-45b2-b732-864e806ffa89","name":"Code","type":"server_js","source":"function doGet(request) {\n  var name \u003d request.parameter.name;\n\n  // Validate inputs\n  if (!name) {\n    Logger.log(\"Error: Missing required fields\");\n    return ContentService.createTextOutput(JSON.stringify({ status: \u0027error\u0027, message: \u0027Missing required fields\u0027 }))\n      .setMimeType(ContentService.MimeType.JSON);\n  }\n\n  // Access the Google Spreadsheet\n  var ss \u003d SpreadsheetApp.openByUrl(\"https://docs.google.com/spreadsheets/d/1X8xIurq1VBxduSGaeW-s93Le5S2BPGWR_CTCEyS3nP4/edit?usp\u003dsharing\");\n  var sheet \u003d ss.getSheetByName(\u0027HealCheck\u0027);\n\n  // Get all data from the sheet\n  var data \u003d sheet.getDataRange().getValues();\n  var found \u003d false;\n\n  for (var i \u003d 1; i \u003c data.length; i++) {\n    if (data[i][1] \u003d\u003d\u003d name) {  // Assuming the \u0027name\u0027 is in the second column (index 1)\n      sheet.deleteRow(i + 1);   // Delete the entire row (i + 1 because sheet rows are 1-based)\n      found \u003d true;\n      Logger.log(\"Match found. Deleting row \" + (i + 1));\n      break;\n    }\n  }\n\n  if (found) {\n    var result \u003d { status: \u0027success\u0027, message: \u0027ยกเลิกการจองเรียบร้อย\u0027 };\n    Logger.log(result.message);\n    return ContentService.createTextOutput(JSON.stringify(result)).setMimeType(ContentService.MimeType.JSON);\n  } else {\n    Logger.log(\"Error: No matching data found\");\n    return ContentService.createTextOutput(JSON.stringify({ status: \u0027error\u0027, message: \u0027No matching data found\u0027 }))\n      .setMimeType(ContentService.MimeType.JSON);\n  }\n}"}]}