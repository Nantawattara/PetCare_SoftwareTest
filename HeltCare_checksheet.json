{"files":[{"id":"7624e99c-a303-4e0d-a0e6-605275dba872","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Asia/Bangkok\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE_ANONYMOUS\"\n  }\n}"},{"id":"6a31b1d0-9860-4b69-be0e-51d6f6f9fed5","name":"Code","type":"server_js","source":"function doGet(request) {\n  var title \u003d request.parameter.title;\n  var name \u003d request.parameter.name;\n  var datecheck \u003d request.parameter.datecheck;\n  var symptom \u003d request.parameter.symptom;\n  var doctor \u003d request.parameter.doctor;\n  var result \u003d \"ยังไม่ตรวจ\"\n  // Validate inputs\n  if (!title || !name || !datecheck || !symptom || !doctor) {\n    return ContentService.createTextOutput(JSON.stringify({ status: \u0027error\u0027, message: \u0027Missing required fields\u0027 }))\n      .setMimeType(ContentService.MimeType.JSON);\n  }\n\n  // Access the Google Spreadsheet\n  var ss \u003d SpreadsheetApp.openByUrl(\"https://docs.google.com/spreadsheets/d/1X8xIurq1VBxduSGaeW-s93Le5S2BPGWR_CTCEyS3nP4/edit?usp\u003dsharing\");\n  var sheet \u003d ss.getSheetByName(\u0027HealCheck\u0027);\n\n  // Get all data from the sheet\n  var data \u003d sheet.getDataRange().getValues();\n\n  // Format the datecheck to \"DD-MM-YYYY\" format\n  var dateParts \u003d datecheck.split(\"-\");\n  var formattedDateCheck \u003d dateParts[2] + \"-\" + dateParts[1] + \"-\" + dateParts[0]; // Rearrange date\n\n  // Append the new row to the spreadsheet\n  sheet.appendRow([title, name, formattedDateCheck, symptom, doctor, result]);\n\n  var result \u003d { status: \u0027success\u0027, message: \u0027เราได้ทำการนัดหมายวันตรวจสุขภาพเรียบร้อยแล้ว กรุณนามาตามวันที่นัดหมาย\u0027 };\n  var resultJSON \u003d JSON.stringify(result);\n  return ContentService.createTextOutput(resultJSON).setMimeType(ContentService.MimeType.JSON);\n}\n"}]}